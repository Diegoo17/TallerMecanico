
<div class="controles-container">
  <div class="botones-ordenamiento">
    <button
      *ngIf="ordenActual === 'antiguo'"
      (click)="ordenarPorFechaReciente()"
      class="boton-ordenar"
    >
      <i class="fas fa-sort-amount-down"></i> Más recientes
    </button>
    <button
      *ngIf="ordenActual === 'reciente'"
      (click)="ordenarPorFechaAntigua()"
      class="boton-ordenar"
    >
      <i class="fas fa-sort-amount-up"></i> Más antiguos
    </button>
  </div>

  <div class="filtro-fecha">
    <label>Filtrar por fecha:</label>
    <div class="tipo-filtro-buttons">
      <button
        [class.active]="tipoFiltroFecha === 'dia'"
        (click)="cambiarTipoFiltro('dia')"
        class="tipo-filtro-btn"
      >
        Por día
      </button>
      <button
        [class.active]="tipoFiltroFecha === 'mes'"
        (click)="cambiarTipoFiltro('mes')"
        class="tipo-filtro-btn"
      >
        Por mes
      </button>
    </div>

    <div class="input-fecha-container">
      <input
        *ngIf="tipoFiltroFecha === 'dia'"
        type="date"
        id="fechaFiltro"
        [(ngModel)]="fechaFiltro"
        (change)="filtrarPorFecha()"
        class="input-fecha"
      >
      <input
        *ngIf="tipoFiltroFecha === 'mes'"
        type="month"
        id="mesAnoFiltro"
        [(ngModel)]="mesAnoFiltro"
        (change)="filtrarPorFecha()"
        class="input-fecha"
      >
      <button
        *ngIf="fechaFiltro || mesAnoFiltro"
        (click)="limpiarFiltro()"
        class="boton-limpiar"
      >
        <i class="fas fa-times"></i> Limpiar filtro
      </button>
    </div>
  </div>
</div>

<div *ngIf="turnosFiltrados.length > 0; else noTurnos">
    <table>
      <thead>
        <tr>
          <th>Título</th>
          <th>Descripción</th>
          <th>Fecha</th>
          <th>Hora</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let turno of turnosFiltrados"
            [class.turno-pasado]="esTurnoPasado(turno.fecha, turno.hora)">
          <td>{{ turno.titulo }}</td>
          <td class="descripcion-cell">
            <div class="descripcion-truncada" (click)="verDescripcionCompleta(turno.descripcion)">
              {{ turno.descripcion }}
            </div>
          </td>
          <td>{{ turno.fecha }}</td>
          <td>{{ turno.hora }}</td>
          <td>
            <button
              (click)="editarTurno(turno)"
              [disabled]="esTurnoPasado(turno.fecha, turno.hora)"
              [class.boton-deshabilitado]="esTurnoPasado(turno.fecha, turno.hora)"
            >
              Editar
            </button>
            <button
              class="eliminar"
              (click)="eliminarTurno(turno)"
              [disabled]="esTurnoPasado(turno.fecha, turno.hora)"
              [class.boton-deshabilitado]="esTurnoPasado(turno.fecha, turno.hora)"
            >
              Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <ng-template #noTurnos>
    <p>No tienes turnos registrados.</p>
  </ng-template>

  <div class="modal-overlay" *ngIf="mostrarModal" (click)="cerrarModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <button class="modal-close" (click)="cerrarModal()">×</button>
      <h3>Descripción completa</h3>
      <p>{{ descripcionSeleccionada }}</p>
    </div>
  </div>
